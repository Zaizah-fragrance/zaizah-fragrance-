<!doctype html><html lang="pt"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Carrinho - Zaizah</title><link rel="stylesheet" href="css/style.css"/></head><body>
<header class="site-header">
  <div class="site-brand"><img src="assets/logo.svg" alt="Zaizah Fragrance logo"><div style="color:#fff"><div style="font-family:Playfair Display,serif;font-size:18px">Zaizah <span style="font-weight:400;color:#dcdcdc">Fragrance</span></div><div style="font-size:11px;color:#bfbfbf">Um cheiro, uma lembrança</div></div></div>
  <nav class="site-nav"><a href="index.html">Início</a><a href="loja.html">Loja</a><a href="sobre.html">Sobre</a><a href="contacto.html">Contacto</a><a href="carrinho.html">Carrinho (<span id="cart-count">0</span>)</a></nav>
</header>
<section class="container">
  <h2>Seu Carrinho</h2>
  <div id="cart-area"></div>
  <div style="margin-top:20px">
    <button id="simulated" class="btn-cta">Pagamento Simulado</button>
    <button id="mpesa" class="btn-cta">Pagar com M-Pesa (Sandbox)</button>
  </div>
</section>
<footer class="footer"><p>© 2025 Zaizah Fragrance</p></footer>
<script>
function currency(mzn){ return new Intl.NumberFormat('pt-MZ',{style:'currency',currency:'MZN'}).format(mzn); }
function getCart(){ return JSON.parse(localStorage.getItem('zaizah_cart')||'[]'); }
function renderCart(){
  const cart = getCart();
  const area = document.getElementById('cart-area');
  area.innerHTML = '';
  if(cart.length===0){ area.innerHTML='<p>O carrinho está vazio.</p>'; return;}
  let total = 0;
  cart.forEach(i=>{
    const div = document.createElement('div'); div.style.display='flex'; div.style.justifyContent='space-between'; div.style.padding='10px 0';
    div.innerHTML = `<div>${i.name} x ${i.q}</div><div>${currency(i.price*i.q)}</div>`;
    area.appendChild(div);
    total += i.price * i.q;
  });
  const t = document.createElement('h3'); t.textContent = 'Total: ' + currency(total); area.appendChild(t);
}
document.getElementById('simulated').addEventListener('click', ()=>{
  alert('Compra simulada concluída. Obrigado!');
  localStorage.removeItem('zaizah_cart'); window.location='index.html';
});
document.getElementById('mpesa').addEventListener('click', async ()=>{
  const cart = getCart();
  if(cart.length===0){ alert('Carrinho vazio'); return; }
  const total = cart.reduce((s,i)=>s+i.price*i.q,0);
  const phone = prompt('Insira o número (ex: 2588XXXXXXXX):','2588');
  if(!phone) return;
  const resp = await fetch('/api/mpesa/stkpush',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({phone,amount:total})});
  const data = await resp.json();
  alert(JSON.stringify(data));
});
document.addEventListener('DOMContentLoaded', renderCart);
</script>
<script src="js/main.js"></script>
</body></html>